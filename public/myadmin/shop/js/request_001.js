define("request@0.2.7/lib/monitor-patch",[],function(t,e,n){"use strict";var s=function(t,e){function n(t){var e=encodeURIComponent,n=[];for(var s in t)t[s]&&n.push(s+"="+e(t[s]));return n.join("&")}function s(t){var e;try{e=t.status}catch(n){return null}return e}e=e||function(t){return t};var r=500;window.__ajaxMonitor={};var i=window.__ajaxMonitor.queue=[],a=function(a){function u(t){var e=document.createElement("a");return e.href=t,e.href}function c(t,e){if(!f){var s=new Date,r=location.host.match(".dianping.com")?"114.80.165.63":"192.168.213.233:8080",c="http://"+r+"/broker-service/api/single?"+n({v:1,ts:+l,tu:u(a.url.split("?")[0]),d:s-l,hs:t,ec:e}),o=new Image;i.push(o),o.onerror=function(){var t=i.indexOf(o);i.splice(t,1)},o.src=c,f=!0}}function o(t){if((h||null!==h)&&clearTimeout(h),4!==t){var e="-90"+t;h=setTimeout(c,r,e,null)}}var h,l,f=!1,p=t(a,function(){c("-910",null)}),d=e(p),g=p.send;return p.send=function(t){function e(t,e){t.onreadystatechange=function(){if(f||o(t.readyState),4===t.readyState&&!f){var n,r=s(t),i=a.contentType;if(!i||-1!==i.indexOf("json"))try{n=JSON.parse(t.responseText),c(r,n.code)}catch(u){c("-905",null)}}e&&p._stateChange()}}return l=new Date,e(d),g.call(p,t),e(d,!0),this},p};return a};n.exports=function(t){return s(function(e,n){return new t(e).on("timeout",n)},function(t){return t.xhr})}},{}),define("request@0.2.7/lib/ajax",["class@~2.0.0","json@~1.0.0","lang@~1.0.0"],function(t,e,n){"use strict";function s(){return new XMLHttpRequest}function r(t){var e,n=!1;try{e=t.status,n=e>=200||300>e||1223===e}catch(s){}return n}function i(){}function a(t){return t}function u(){return!0}function c(t,e){return t+(t.indexOf("?")>-1?"&":"?")+e}var o=t("class"),h=t("json"),l=t("lang"),f=4,p=window,d="",g="POST",v="GET",m="json",_="withCredentials",x=/#.*$/,y=p.ActiveXObject?function(){if(p.XMLHttpRequest)try{return s()}catch(t){}try{return new p.ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}:s,j={"X-Requested-With":"XMLHttpRequest"},w={Accept:{xml:"aplication/xml, text/xml",html:"text/html",script:"text/javascript, application/javascript",json:"application/json, text/javascript",text:"text/plain","*":"*/*"},"X-Request":{json:"JSON"}},R={xml:"responseXML",text:"responseText"},b=y(),O="onprogress"in b,T=o({Implements:"attrs events",initialize:function(t){var e=l.bind;this.set(t),this.xhr=y(),e("_stateChange",this),O&&(e("_loadstart",this),e("_progress",this))},_stateChange:function(){var t,e=this.xhr;e.readyState===f&&this.running&&(this.running=!1,e.onreadystatechange=i,clearTimeout(this.timer),t=this._parseResponse(e),this.emit(!this.parseError&&this.get("isXHRSuccess")(e)&&this.get("isSuccess")(t)?"success":"error",t,e))},_parseResponse:function(t){var e,n=this.get("santitizer"),s=this.get("parser"),r=this.get("dataType"),i=R;if(e=n(t[i[r]||i.text]||t[i.text]),r.indexOf(m)>-1)try{e=h.parse(e),this.parseError=!1}catch(a){e={},this.parseError=!0}return s(e)},send:function(t){var e=this.get("method"),n=this.get("url"),s=this.get("timeout"),r=this.get("user"),i=this.get("async"),a=this.xhr;this.running=!0,t=this._tidyRequest(t),e===v&&(this.get("cache")||(n=c(n,"_nr_force="+ +new Date)),t&&(n=c(n,t),t=void 0)),O&&(a.onloadstart=this._loadstart,a.onprogress=this._progress),r?a.open(e,n,i,r,this.get("password")):a.open(e,n,i),r&&_ in a&&(a[_]=!0),a.onreadystatechange=this._stateChange,l.each(this.get("headers"),function(t,e){try{a.setRequestHeader(e,t)}catch(n){}}),this.emit("request"),a.send(t),!i&&this._stateChange();var u=this;return s&&(this.timer=setTimeout(function(){u.emit("timeout"),u.cancel()},s)),this},_tidyRequest:function(t){return t=(void 0===t?this.get("data"):t)||d,l.isObject(t)&&(t=l.toQueryString(t)),t},_loadstart:function(t){this.emit("loadstart",[t,this.xhr])},_progress:function(t){this.emit("progress",[t,this.xhr])},cancel:function(){var t=this.xhr;return this.running&&(this.running=!1,t.abort(),clearTimeout(this.timer),t.onreadystatechange=i,O&&(t.onprogress=t.onloadstart=i),this.xhr=y(),this.emit("cancel")),self}},{url:{value:d,getter:function(t){return String(t).replace(x,d)||location.pathname}},method:{value:v,setter:function(t){return t=(""+t).toUpperCase(),t===v||t===g?t:v}},dataType:{value:m,setter:function(t){return t||"*"}},async:{value:!0},timeout:{value:0},cache:{value:!1},user:{value:d},password:{value:d},headers:{getter:function(t){l.isObject(t)||(t={});var e=this.get("dataType"),n=this.get("method"),s=w;return l.mix(t,j,!1),l.each(s,function(s,r){var i=s[e];i&&(t[r]=i),n===g&&(t["Content-Type"]="application/x-www-form-urlencoded;charset=UTF-8")}),t}},parser:{value:a},santitizer:{value:a},isSuccess:{value:u},isXHRSuccess:{value:r},data:{}});b=null,n.exports=T},{}),define("request@0.2.7/lib/jsonp",["class@~2.0.0","lang@~1.0.0","asset@~1.0.0"],function(t,e,n){"use strict";function s(t,e,n){if(t){var s="&",r=t.length-1,i=t[0]===s,a=t[r]===s;t=e?i?t:s+t:i?t.substr(1):t,r=t.length-1,t=n?a?t:t+s:a?t.substr(0,r):err}return t||""}var r=t("class"),i=t("lang"),a=t("asset"),u=+new Date,c="_JSONPCallback",o=r({Implements:"events attrs",initialize:function(t){this.set(t)},_tidyRequest:function(t){return t=(void 0===t?this.get("data"):t)||"",i.isObject(t)&&(t=i.toQueryString(t)),this.get("cache")||(t+="&_nr_force="+ +new Date),t},_getQuestURL:function(t,e,n,r){return t=t.split("?"),t[0]+"?"+s(t[1],!1,!0)+s(n,!1,!0)+e+"="+o._HOLDER_NAME+"._"+r},send:function(t){var e,n=this._tidyRequest(t),s=++u,r=o._HOLDER,i=this.get("timeout");if(e=this._getQuestURL(this.get("url"),this.get("callbackKey"),n,s),e.length>2083)return this.emit("error",e);var c=this;return r["_"+s]=function(){c.__success.apply(c,arguments),delete r["_"+s]},this._clear(),this.script=a.js(e,!1,{remove:!0}),this.emit("request"),i&&setTimeout(function(){c.emit("timeout"),c.cancel()},i),s},__success:function(){this.emit.apply(this,["success"].concat(arguments))},cancel:function(){return this._clear().emit("cancel")},_clear:function(){return this.script=null,this}},{url:{value:""},callbackKey:{value:"callback"},data:{},timeout:{value:0},cache:{value:!1}});o.setNS=function(t){var e,n="";t?(e=window[t],Object(e)!==e&&(e=window[t]={}),n=t+"."):e=window,o._HOLDER_NAME=n+c,o._HOLDER=e[c]||(e[c]={})},o.setNS("NR"),n.exports=o},{}),define("request@0.2.7/lib/index",["./monitor-patch","./ajax","./jsonp"],function(t,e,n){"use strict";{var s=n.exports={},r=t("./monitor-patch");s.Ajax=r(t("./ajax")),s.JSONP=t("./jsonp")}},{main:!0});