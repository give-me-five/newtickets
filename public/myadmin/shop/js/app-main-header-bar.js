define("app-main-header-bar@1.0.1/lib/index",["jquery@~1.9.2","request@~0.2.0","tpl@~0.2.0"],function(a,b){"use strict";function c(){var a=i(".footer .fn-tuan"),b=i(".footer .tuan-nav"),c=!1;a.length&&b.length&&(a.on("click",function(a){a.preventDefault(),b.show(),c=!c}),b.on("click",function(a){a.stopPropagation()}),i("body").on("click",function(){b.css("display","none"),c=!1}))}function d(a,b,c){function d(){c&&a.addClass(l),b.css("visibility","visible"),b.data("shown",!0)}function e(){c&&a.removeClass(l),b.css("visibility","hidden"),b.data("shown",!1)}var f={mouseenter:d,mouseleave:e};return b.data("shown",!1),b.on(f),a.on(f),{hide:e}}function e(){i(".J_auto-load").each(f);var a=i("#G_h-qn"),b=i("#G_h-qn-panel");d(a,b,!0);var e=i("#G_h-uc"),g=i("#G_h-uc-panel");d(e,g,!0),c(),h()}function f(a,b){var c,d,e=i("body");b=i(b),d=b[0].tagName.toLowerCase(),c="script"==d?b.html().trim():b.val().trim(),c&&i(c).each(function(a,b){b=i(b);var c=b.attr("data-target");c=c?i(c):e,b.appendTo(c)}),b.remove()}function g(a,b,c){var d=["","replies","badge","fans","msg","notice"],e=a+"/member/jsonp/unreadMsg",f=a+"/member/jsonp/ignoreMsg";new j({url:e,data:{rand:1e3*Math.random()}}).on("success",function(a){if(a&&a.msg&&200===a.code){var e=a.msg.mc||[],g=i("#J_tpl-msg").html();if(e.length&&g){e.ENUM=d;var h=k.compile(g),l=i(h(e)),m=e.reduce(function(a,b){return a+b.count},0),n={sum:m,panel:l};m&&b&&b(n),l.find(".ignore").on("click",function(a){a.stopPropagation(),a.preventDefault(),new j({url:f,data:{rand:1e3*Math.random()}}).on({success:function(){c&&c(n)}}).send()})}}}).send()}function h(){var a=i("#G_h-msg");if(a.length){var b=i(".i-msg");b.length&&g(a.attr("data-server")||"",function(c){var d=c.panel,e=a.attr("data-ga-unread");c.sum&&e&&dpga(e),i("<span>").text(c.sum).appendTo(a),b.removeClass("Hide"),d.appendTo(b),b.on({mouseenter:function(){b.data("disabled")||(a.toggleClass("active"),d.css("visibility","visible"),window._hip&&_hip.push(["mv",{v_u_m:1}]))},mouseleave:function(){b.data("disabled")||(a.toggleClass("active"),d.css("visibility","hidden"))}})},function(c){c.panel.remove(),a.find("span").remove(),b.trigger("mouseleave").data("disabled",1)})}}var i=a("jquery"),j=a("request").JSONP,k=a("tpl"),l="active";b.init=function(){i(e)},b.initLazyLoad=f},{main:!0});